<?xml version="1.0" encoding="utf-8"?>
<s:Application xmlns:fx="http://ns.adobe.com/mxml/2009" 
			   xmlns:s="library://ns.adobe.com/flex/spark" 
			   xmlns:mx="library://ns.adobe.com/flex/mx" width="1050" height="650"
			   xmlns:view="view.*"
			   applicationComplete="init()">
	
	<fx:Script>
		<![CDATA[
			import Model.UserModel;
			
			import MyEvent.CustomEvent;
			
			import flash.events.*;
			
			import mx.core.UIComponent;
			import mx.utils.ObjectUtil;
			
			private var usermodel:UserModel;
			
			private function init():void
			{
				usermodel = UserModel.instance;
				
//				var testEvent:CustomEvent = new CustomEvent("test");
//				testEvent.user = "gabe";
//				testEvent.password = "aaaa";
//				dispatchEvent(testEvent);
				
				name_txt.text = "Nerse", pwd_txt.text = "aaaa";
			}
			
			private function login():void
			{
				var status:Object = usermodel.login(name_txt.text, pwd_txt.text);
				if ( status.result ) {
					id_lab.text = "user:"+usermodel.self.name;
				} else {
					id_lab.text = status.msg;
				}
			}
			
			private function clear():void
			{
				status_txt.text = "";
			}
			
			private function finish():void
			{
				usermodel.finish();
			}
			
			private function closeSwfHandler(e:Event):void
			{
				usermodel.logout();	
			}
		]]>
	</fx:Script>
	<s:VGroup x="5" y="5" gap="30">
		<s:HGroup>
			<s:TextInput  id="name_txt" />
			<s:TextInput id="pwd_txt" />
			<s:Button label="login" click="login()" />
			<s:Button label="logout" click="{usermodel.logout()}" />
		</s:HGroup>
		<s:HGroup >
			<view:Player/>
			<s:VGroup>
				<view:Department id="userList"/>
				<s:Label id="id_lab"/>
			</s:VGroup>
			<s:VGroup>
			   	<s:TextArea id="status_txt"  width="500" height="300"/>
		 		<s:Button label="clear" click="clear()"/>	
			</s:VGroup>
		</s:HGroup>
		<s:HGroup >
		</s:HGroup>
 		<s:Button label="finish" click="finish()"/>	
	</s:VGroup>
</s:Application>